### 视图



###### 无用  GenericAPIView

~~~python
from api.utils.serializsers.pager import PagerSerialiser
from rest_framework.generics import GenericAPIView

class View1View(GenericAPIView): # APIView
    queryset = models.Role.objects.all()
    serializer_class = PagerSerialiser
    pagination_class = PageNumberPagination
    
    def get(self,request,*args,**kwargs):
        # 获取数据
        roles = self.get_queryset() # models.Role.objects.all()

        # [1, 1000,]     [1,10]
        pager_roles = self.paginate_queryset(roles)

        # 序列化
        ser = self.get_serializer(instance=pager_roles,many=True)

        return Response(ser.data)
~~~



###### GenericViewSet  

~~~python
# 继承关系
# ViewSetMixin  重写了路由分发

GenericViewSet(ViewSetMixin, generics.GenericAPIView)
~~~



~~~python
# 路由：
url(r'^(?P<version>[v1|v2]+)/v1/$', views.View1View.as_view({'get': 'list'})),  # 因为ViewSetMixin导致路由发生变化    

# 视图：
from api.utils.serializsers.pager import PagerSerialiser
from rest_framework.viewsets import GenericViewSet

class View1View(GenericViewSet):
    queryset = models.Role.objects.all()
    serializer_class = PagerSerialiser
    pagination_class = PageNumberPagination

    def list(self, request, *args, **kwargs):
        # 获取数据
        roles = self.get_queryset()  # models.Role.objects.all()

        # [1, 1000,]     [1,10]
        pager_roles = self.paginate_queryset(roles)

        # 序列化
        ser = self.get_serializer(instance=pager_roles, many=True)

        return Response(ser.data)
~~~



###### ModelViewSet

~~~python
# 路由系统：  一个视图多个路由
url(r'^(?P<version>[v1|v2]+)/v1/$', views.View1View.as_view({'get': 'list','post':'create'})),
url(r'^(?P<version>[v1|v2]+)/v1/(?P<pk>\d+)/$', views.View1View.as_view({'get': 'retrieve','delete':'destroy','put':'update','patch':'partial_update'})),

# 视图：
from api.utils.serializsers.pager import PagerSerialiser
from rest_framework.viewsets import GenericViewSet,ModelViewSet
from rest_framework.mixins import ListModelMixin,CreateModelMixin

class View1View(ModelViewSet):
    queryset = models.Role.objects.all()
    serializer_class = PagerSerialiser
    pagination_class = PageNumberPagination
  

# 注意： 
1. 当视图继承 ModelViewSet 时，序列化类需要继承 ModelSerializer 才能发送 post 请求，否则提示 没有 create方法
~~~



###### 总结

~~~python
总结：
    a. 增删改查  ModelViewSet
    b. 增删     CreateModelMixin,DestroyModelMixin  GenericViewSet
    c. 复杂逻辑  GenericViewSet 或 APIView 

PS:
    GenericAPIView.get_object
    check_object_permissions
    has_object_permission

# 其他可继承类
ListAPIView: 取多条数据
CreateAPIView 用于GET
RetrieveAPIView: 取一条数据
UpdateAPIView
DestroyAPIView
ListCreateAPIView
~~~



###### 类之间的继承关系

![ModelViewSet继承关系](pictures\ModelViewSet继承关系.png)